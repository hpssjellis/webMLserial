<!DOCTYPE html>
<html>
<head>
  <title>IMU Data Classification with TensorFlow.js</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.7.0/dist/tf.min.js"></script>
</head>
<body>
  <h1>IMU Data Classification</h1>

  <div id="status">Loading model...</div>

  <script>
    // Define the pre-trained model URL
    const modelUrl = 'model/model.json';

    // Define the acceleration data and labels
    const accelerationData = [
      { x: 0.1, y: 0.2, z: 0.3 },
      { x: 0.2, y: 0.3, z: 0.4 },
      // Add more acceleration data objects here
    ];

    const labels = ['punch', 'arm lift', /* Add more labels here */];

    // Load the pre-trained model
    async function loadModel() {
      const model = await tf.loadLayersModel(modelUrl);
      return model;
    }

    // Normalize the acceleration data
    function normalizeData(data) {
      const normalizedData = tf.tidy(() => {
        const tensorData = tf.tensor2d(data, [data.length, 3]);
        const dataMean = tensorData.mean(0);
        const dataStd = tensorData.sub(dataMean).square().mean(0).sqrt();
        return tensorData.sub(dataMean).div(dataStd);
      });
      return normalizedData;
    }

    // Classify the normalized data
    function classifyData(model, data) {
      const tensorData = tf.tensor2d(data, [1, data.length]);
      const predictions = model.predict(tensorData);
      const predictedLabelIndex = predictions.argMax(1).dataSync()[0];
      const predictedLabel = labels[predictedLabelIndex];
      return predictedLabel;
    }

    // Main function
    async function run() {
      // Load the model
      const model = await loadModel();
      document.getElementById('status').innerText = 'Model loaded.';

      // Normalize and classify the acceleration data
      const normalizedData = normalizeData(accelerationData);
      const predictedLabel = classifyData(model, normalizedData.arraySync());

      // Display the predicted label
      document.getElementById('status').innerText = `Predicted label: ${predictedLabel}`;
    }

    // Run the main function
    run();
  </script>
</body>
</html>
