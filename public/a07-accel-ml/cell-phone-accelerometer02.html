<!DOCTYPE html>
<html>
<head>
  <title>Accelerometer Data and TensorFlow.js Model</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.8.0/dist/tf.js"></script>
</head>
<body>
  <h1>Accelerometer Data and TensorFlow.js Model</h1>
  <div id="output"></div>

  <script>
    // TensorFlow model
    const model = tf.sequential();
    // Add your model layers here
    // model.add(...);

    // Check if the device supports the DeviceMotion event
    if (window.DeviceMotionEvent) {
      // DeviceMotion event listener
      window.addEventListener('devicemotion', handleMotionEvent);
    } else {
      document.getElementById('output').innerHTML = 'DeviceMotion not supported.';
    }

    let accelerometerData = [];
    let startTime = null;

    // Event handler for DeviceMotion event
    function handleMotionEvent(event) {
      const acceleration = event.acceleration;
      const x = acceleration.x;
      const y = acceleration.y;
      const z = acceleration.z;

      // Start collecting data if startTime is null
      if (startTime === null) {
        startTime = performance.now();
      }

      // Calculate elapsed time in milliseconds
      const elapsedTime = performance.now() - startTime;

      // Collect accelerometer data for 500 ms
      if (elapsedTime < 500) {
        accelerometerData.push([x, y, z]);
      } else {
        // Preprocess the collected accelerometer data and use it for inference with TensorFlow.js
        const input = tf.tensor2d(accelerometerData);
     //   const prediction = model.predict(input);
        const predictedLabel = prediction.dataSync()[0];
        const result = predictedLabel === 0 ? 'punch' : 'get up';

      //  document.getElementById('output').innerHTML = `<p>Prediction: ${result}</p>`;
        document.getElementById('output').innerHTML = `<p>accelerometerData: ${accelerometerData}</p>`;

        // Reset variables for the next data collection
        accelerometerData = [];
        startTime = null;
      }
    }
  </script>
</body>
</html>
